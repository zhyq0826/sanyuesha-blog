---
import Layout from "~/layouts/Layout.astro";
import { getCollection } from "astro:content";
import { dateString } from "~/utils";

const projects = (
  await getCollection("projects", ({ data }) =>
    import.meta.env.PROD ? data.draft !== true : true
  )
).sort((a, b) => (a.data.date < b.data.date ? 1 : -1));
---

<Layout title="Projects" description="正在做与已发布的项目">
  <section class="space-y-5">
    <h1 class="text-3xl font-semibold text-heading1">Projects</h1>
    {projects.map((item) => (
      <article class="border border-foreground/12 rounded-xl p-5 bg-foreground/2 hover:border-accent/30 transition-colors">
        <div class="text-sm text-foreground/80">{dateString(item.data.date)}</div>
        <h2 class="text-2xl font-semibold mt-2"># {item.data.title}</h2>
        <p class="mt-3 text-foreground/80">{item.data.summary}</p>
        <div class="flex flex-wrap gap-2 mt-3 items-center text-sm text-foreground/80">
          <span class="rounded-full px-3 py-1 border border-foreground/16 bg-foreground/3 uppercase tracking-wide text-xs">
            {item.data.status}
          </span>
          {item.data.tags?.map((tag) => (
            <span class="rounded-full px-3 py-1 border border-foreground/16 bg-foreground/3">
              #{tag}
            </span>
          ))}
        </div>
        <div class="flex flex-wrap gap-3 mt-4 text-sm">
          {item.data.link && (
            <a class="button" href={item.data.link} target="_blank" rel="noreferrer">
              Demo
            </a>
          )}
          {item.data.repo && (
            <a class="button" href={item.data.repo} target="_blank" rel="noreferrer">
              Repo
            </a>
          )}
        </div>
      </article>
    ))}
    {projects.length === 0 && (
      <div class="border border-foreground/12 rounded-xl p-5 text-foreground/70">
        暂无项目。
      </div>
    )}
  </section>
</Layout>

