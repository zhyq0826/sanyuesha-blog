---
import Layout from "~/layouts/Layout.astro";
import { getCollection } from "astro:content";
import { dateString } from "~/utils";

const insights = (
  await getCollection("insights", ({ data }) =>
    import.meta.env.PROD ? data.draft !== true : true
  )
).sort((a, b) => (a.data.date < b.data.date ? 1 : -1));
---

<Layout title="Insights" description="灵感、观察与短文笔记">
  <section class="space-y-5">
    <h1 class="text-3xl font-semibold text-heading1">Insights</h1>
    {insights.map((item) => (
      <article class="border border-foreground/12 rounded-xl p-5 bg-foreground/2 hover:border-accent/30 transition-colors">
        <div class="text-sm text-foreground/80">{dateString(item.data.date)}</div>
        <h2 class="text-2xl font-semibold mt-2">
          <a href={`/insights/${item.slug}`}># {item.data.title}</a>
        </h2>
        <p class="mt-3 text-foreground/80">
          {item.data.description ?? item.data.summary}
        </p>
        {item.data.tags?.length ? (
          <div class="flex flex-wrap gap-2 mt-3">
            {item.data.tags.map((tag) => (
              <span class="rounded-full px-3 py-1 text-sm border border-foreground/16 bg-foreground/3">
                #{tag}
              </span>
            ))}
          </div>
        ) : null}
      </article>
    ))}
    {insights.length === 0 && (
      <div class="border border-foreground/12 rounded-xl p-5 text-foreground/70">
        暂无内容，稍后再来看看。
      </div>
    )}
  </section>
</Layout>

